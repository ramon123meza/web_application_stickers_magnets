const e={products:"https://2dfneuzbdy7a5byfadntplirwq0aznhv.lambda-url.us-east-1.on.aws/",pricing:"https://6fcoaqeruuzs45nhhsjqbgvjwu0ophzz.lambda-url.us-east-1.on.aws/",upload:"https://5ad2zug7mffadde2r37f5rtrny0hcxmc.lambda-url.us-east-1.on.aws/",orders:"https://a2tc6korkbyclpq7i3y7ar5r240fmnqt.lambda-url.us-east-1.on.aws/",contact:"https://ccphcykjv3tsgazhh63aivdyoq0tntve.lambda-url.us-east-1.on.aws/"};class t extends Error{constructor(e,t,s=null){super(e),this.name="ApiError",this.status=t,this.data=s}}const s=async(e,r,o=3)=>{const{signal:n,clear:a}=(e=>{const t=new AbortController,s=setTimeout(()=>t.abort(),e);return{signal:t.signal,clear:()=>clearTimeout(s)}})(r.timeout||3e4);try{const s=await fetch(e,{...r,signal:n});if(a(),!s.ok){const e=await s.json().catch(()=>({}));throw new t(e.message||`HTTP error! Status: ${s.status}`,s.status,e)}return s}catch(l){if(a(),"AbortError"===l.name)throw new t("Request timeout",408);if(l instanceof t&&l.status>=400&&l.status<500)throw l;if(o>0)return l.message,await(i=1e3,new Promise(e=>setTimeout(e,i))),s(e,r,o-1);throw l}var i},r=async(t,r={})=>{const o=e[t]||t,n={headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:3e4},a={...n,...r,headers:{...n.headers,...r.headers}};a.method,a.body;try{const e=await s(o,a),t=await(async e=>{const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():e.text()})(e);return t}catch(i){throw i}},o={getProducts:async(t=null)=>{const s=new URLSearchParams;t&&s.append("type",t);const o=s.toString();return r(o?`${e.products}?${o}`:e.products,{method:"GET"})},getPricing:async(t,s=null)=>{const o=new URLSearchParams({type:t});s&&o.append("size",s);const n=`${e.pricing}?${o.toString()}`;return r(n,{method:"GET"})},upload:{uploadImage:async({image:e,filename:t,sessionId:s})=>r("upload",{method:"POST",body:JSON.stringify({image:e,filename:t,sessionId:s}),timeout:6e4})},createOrder:async e=>r("orders",{method:"POST",body:JSON.stringify(e)}),getOrder:async t=>{const s=`${e.orders}?orderId=${encodeURIComponent(t)}`;return r(s,{method:"GET"})},submitContact:async e=>r("contact",{method:"POST",body:JSON.stringify({...e,timestamp:(new Date).toISOString()})})},n={name:"TRACE",priority:0,color:"#9CA3AF"},a={name:"DEBUG",priority:1,color:"#3B82F6"},i={name:"INFO",priority:2,color:"#10B981"},l={name:"WARN",priority:3,color:"#F59E0B"},c={name:"ERROR",priority:4,color:"#EF4444"},h={name:"FATAL",priority:5,color:"#7C2D12"},g={API:"API",AUTH:"AUTH",CANVAS:"CANVAS",UPLOAD:"UPLOAD",PAYMENT:"PAYMENT",ORDER:"ORDER",UI:"UI",VALIDATION:"VALIDATION",COMPRESSION:"COMPRESSION",GENERAL:"GENERAL"};class u{constructor(){this.level=i,this.enabledCategories=new Set(Object.values(g)),this.enableConsole=!0,this.enableStorage=!0,this.maxStorageEntries=1e3,this.enableRemoteLogging=!1,this.remoteEndpoint=null}setLevel(e){return this.level=e,this}setCategories(e){return this.enabledCategories=new Set(e),this}enableConsoleOutput(e=!0){return this.enableConsole=e,this}enableLocalStorage(e=!0){return this.enableStorage=e,this}setMaxStorageEntries(e){return this.maxStorageEntries=e,this}}class d{constructor(e,t,s,r={},o=null){this.timestamp=(new Date).toISOString(),this.level=e.name,this.category=t,this.message=s,this.context=r,this.error=o?this.serializeError(o):null,this.sessionId=this.getSessionId(),this.userAgent=navigator.userAgent,this.url=window.location.href,this.id=this.generateId()}serializeError(e){return{name:e.name,message:e.message,stack:e.stack,...e}}getSessionId(){let e=sessionStorage.getItem("loggerSessionId");return e||(e=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("loggerSessionId",e)),e}generateId(){return`log-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}class m{constructor(){this.issues=new Map,this.maxIssues=100}track(e){const t=`${e.category}-${e.level}`;this.issues.has(t)||this.issues.set(t,{category:e.category,level:e.level,count:0,lastOccurred:null,firstOccurred:null,samples:[]});const s=this.issues.get(t);s.count++,s.lastOccurred=e.timestamp,s.firstOccurred||(s.firstOccurred=e.timestamp),s.samples.length<5&&s.samples.push({message:e.message,context:e.context,timestamp:e.timestamp})}getSummary(){return Array.from(this.issues.values()).sort((e,t)=>t.count-e.count).slice(0,this.maxIssues)}clear(){this.issues.clear()}}const p=new class{constructor(){this.config=new u,this.storage=[],this.listeners=new Set,this.issueTracker=new m,this.setupGlobalErrorHandling()}configure(e){return e(this.config),this}addListener(e){return this.listeners.add(e),this}removeListener(e){return this.listeners.delete(e),this}setupGlobalErrorHandling(){window.addEventListener("unhandledrejection",e=>{this.error(g.GENERAL,"Unhandled Promise Rejection",{reason:e.reason,promise:e.promise},e.reason)}),window.addEventListener("error",e=>{this.error(g.GENERAL,"Global JavaScript Error",{filename:e.filename,lineno:e.lineno,colno:e.colno,message:e.message},e.error)}),window.addEventListener("error",e=>{e.target!==window&&this.warn(g.GENERAL,"Resource Load Error",{tagName:e.target.tagName,src:e.target.src||e.target.href,type:e.target.type})},!0)}log(e,t,s,r={},o=null){if(e.priority<this.config.level.priority)return;if(!this.config.enabledCategories.has(t))return;const n=new d(e,t,s,r,o);this.config.enableStorage&&(this.storage.push(n),this.storage.length>this.config.maxStorageEntries&&this.storage.shift()),this.config.enableConsole&&this.outputToConsole(n,e),this.listeners.forEach(e=>{try{e(n)}catch(t){}}),e.priority>=l.priority&&this.issueTracker.track(n),this.config.enableRemoteLogging&&this.config.remoteEndpoint&&this.sendToRemote(n)}outputToConsole(e,t){e.timestamp.split("T")[1].split(".")[0],t.name,e.category,t.color;if(e.error)e.context&&Object.keys(e.context).length;else{t.priority>=c.priority||(t.priority,l.priority)}}async sendToRemote(e){try{await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){}}trace(e,t,s={}){this.log(n,e,t,s)}debug(e,t,s={}){this.log(a,e,t,s)}info(e,t,s={}){this.log(i,e,t,s)}warn(e,t,s={},r=null){this.log(l,e,t,s,r)}error(e,t,s={},r=null){this.log(c,e,t,s,r)}fatal(e,t,s={},r=null){this.log(h,e,t,s,r)}getLogs(e={}){let t=[...this.storage];return e.level&&(t=t.filter(t=>t.level===e.level)),e.category&&(t=t.filter(t=>t.category===e.category)),e.after&&(t=t.filter(t=>new Date(t.timestamp)>new Date(e.after))),e.before&&(t=t.filter(t=>new Date(t.timestamp)<new Date(e.before))),t}getLogsAsString(e={}){return this.getLogs(e).map(e=>{let t=`[${e.timestamp}] [${e.level}] [${e.category}] ${e.message}`;return Object.keys(e.context).length>0&&(t+=`\nContext: ${JSON.stringify(e.context,null,2)}`),e.error&&(t+=`\nError: ${e.error.message}\n${e.error.stack}`),t}).join("\n\n")}exportLogs(e=`logs-${(new Date).toISOString().split("T")[0]}.json`){const t=JSON.stringify(this.storage,null,2),s=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(s),o=document.createElement("a");o.href=r,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}clear(){this.storage=[],this.issueTracker.clear()}getIssues(){return this.issueTracker.getSummary()}},y={debug:(e,t)=>p.debug(g.UPLOAD,e,t),info:(e,t)=>p.info(g.UPLOAD,e,t),warn:(e,t,s)=>p.warn(g.UPLOAD,e,t,s),error:(e,t,s)=>p.error(g.UPLOAD,e,t,s)},f={debug:(e,t)=>p.debug(g.ORDER,e,t),info:(e,t)=>p.info(g.ORDER,e,t),warn:(e,t,s)=>p.warn(g.ORDER,e,t,s),error:(e,t,s)=>p.error(g.ORDER,e,t,s)};export{o as a,f as o,y as u};
